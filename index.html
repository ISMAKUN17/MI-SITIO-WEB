<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Reservas</title>
    <style>
        /* Estilos generales */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f0f5;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* Contenedores */
        .form-container, .table-container {
            background-color: #fff;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            width: 90%;
            max-width: 600px;
            margin-bottom: 20px;
        }

        /* Encabezados */
        h2 {
            text-align: center;
            color: #333;
            font-weight: 600;
            margin-bottom: 15px;
        }

        /* Etiquetas y entradas */
        label {
            font-weight: 600;
            display: block;
            margin-bottom: 8px;
            color: #555;
        }

        input, select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            border-color: #4CAF50;
            outline: none;
        }

        input[type="submit"] {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        input[type="submit"]:hover {
            background-color: #43a047;
        }

        /* Tabla de reservas */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
        }

        th {
            background-color: #4CAF50;
            color: white;
            font-weight: bold;
        }

        td {
            background-color: #f9f9f9;
            transition: background-color 0.3s ease;
        }

        tr:hover td {
            background-color: #f1f1f1;
        }

        /* Ajuste para pantallas pequeñas */
        @media (max-width: 600px) {
            .form-container, .table-container {
                width: 100%;
                padding: 15px;
            }

            table {
                font-size: 14px;
            }

            input, select {
                font-size: 14px;
            }

            input[type="submit"] {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>

    <div class="form-container">
        <h2>Formulario de Reservas</h2>
        <form id="reservaForm">
            <div class="form-group">
                <label for="fecha">Fecha</label>
                <input type="date" id="fecha" name="fecha" required>
            </div>
            <div class="form-group">
                <label for="room">Room</label>
                <input type="text" id="room" name="room" placeholder="Número de habitación" required pattern="\d{4}">
            </div>
            <div class="form-group">
                <label for="nombre">Nombre</label>
                <input type="text" id="nombre" name="nombre" placeholder="Nombre del huésped" required>
            </div>
            <div class="form-group">
                <label for="restaurante">Restaurante</label>
                <select id="restaurante" name="restaurante" required>
                    <option value="">Seleccione un restaurante</option>
                    <option value="Himitsu">Himitsu</option>
                    <option value="El Patio">El Patio</option>
                    <option value="Bluewater Grill">Bluewater Grill</option>
                    <option value="Olio">Olio</option>
                    <option value="Bordeaux">Bordeaux</option>
                    <option value="Hibachi">Hibachi</option>
                </select>
            </div>
            <div class="form-group">
                <label for="hora">Hora</label>
                <select id="hora" name="hora" required>
                    <option value="">Seleccione un horario</option>
                </select>
            </div>
            <div class="form-group">
                <label for="pax">PAX</label>
                <input type="number" id="pax" name="pax" placeholder="Número de personas" required>
            </div>
            <div class="form-group">
                <label for="notas">Notas</label>
                <input type="text" id="notas" name="notas" placeholder="Notas adicionales (opcional)">
            </div>
            <input type="submit" value="Reservar">
        </form>
    </div>

    <div class="table-container">
        <h2>Reservas</h2>
        <table id="reservasTable">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Room</th>
                    <th>Nombre</th>
                    <th>Restaurante</th>
                    <th>Hora</th>
                    <th>PAX</th>
                    <th>Notas</th>
                </tr>
            </thead>
            <tbody>
                <!-- Las reservas se agregarán aquí dinámicamente -->
            </tbody>
        </table>
    </div>

    <script>
        // Capturamos el formulario y la tabla
        const form = document.getElementById('reservaForm');
        const reservasTable = document.getElementById('reservasTable').getElementsByTagName('tbody')[0];

        // Opciones de horarios por restaurante
        const horariosRestaurantes = {
            "Himitsu": ["6:00 PM", "7:30 PM", "8:30 PM", "9:45 PM"],
            "El Patio": ["6:00 PM", "7:30 PM", "8:30 PM", "9:45 PM"],
            "Bluewater Grill": ["6:00 PM", "7:30 PM", "8:30 PM", "9:45 PM"],
            "Olio": ["6:00 PM", "7:30 PM", "8:30 PM", "9:45 PM"],
            "Bordeaux": ["6:00 PM", "7:30 PM", "8:30 PM", "9:45 PM"],
            "Hibachi": ["6:00 PM", "7:15 PM", "8:30 PM", "9:45 PM"]
        };

        // Limites de pax por restaurante
        const limitePax = {
            "Himitsu": 8,
            "El Patio": 8,
            "Bluewater Grill": 8,
            "Olio": 8,
            "Bordeaux": 8,
            "Hibachi": 10
        };

        // Almacenamos el total de pax por cada horario
        const reservasPorHorario = {};

        // Seleccionamos los elementos del restaurante y hora
        const restauranteSelect = document.getElementById('restaurante');
        const horaSelect = document.getElementById('hora');

        // Cargar reservas del local storage al iniciar
        window.onload = function() {
            const reservas = JSON.parse(localStorage.getItem('reservas')) || [];
            reservas.forEach(reserva => {
                addRowToTable(reserva);
            });
        };

        // Función para agregar una fila a la tabla
        function addRowToTable(reserva) {
            const newRow = reservasTable.insertRow();
            newRow.innerHTML = `<td>${reserva.fecha}</td><td>${reserva.room}</td><td>${reserva.nombre}</td><td>${reserva.restaurante}</td><td>${reserva.hora}</td><td>${reserva.pax}</td><td>${reserva.notas}</td>`;
        }

        // Función para actualizar los horarios según el restaurante seleccionado
        restauranteSelect.addEventListener('change', function() {
            const restauranteSeleccionado = this.value;

            // Limpiamos los horarios previos
            horaSelect.innerHTML = '<option value="">Seleccione un horario</option>';

            // Llenamos los horarios de acuerdo al restaurante seleccionado
            if (horariosRestaurantes[restauranteSeleccionado]) {
                horariosRestaurantes[restauranteSeleccionado].forEach(hora => {
                    const option = document.createElement('option');
                    option.value = hora;
                    option.textContent = hora;
                    horaSelect.appendChild(option);
                });
            }
        });

        // Manejador de envío del formulario
        form.addEventListener('submit', function(e) {
            e.preventDefault(); // Prevenir el envío del formulario

            const fecha = document.getElementById('fecha').value;
            const room = document.getElementById('room').value;
            const nombre = document.getElementById('nombre').value;
            const restaurante = restauranteSelect.value;
            const hora = horaSelect.value;
            const pax = document.getElementById('pax').value;
            const notas = document.getElementById('notas').value;

            // Validar que los campos están completos
            if (!fecha || !room || !nombre || !restaurante || !hora || !pax) {
                alert("Por favor completa todos los campos requeridos.");
                return;
            }

            // Comprobar si el límite de pax se ha alcanzado para el horario seleccionado
            if (!reservasPorHorario[hora]) {
                reservasPorHorario[hora] = 0; // Inicializar el conteo para el horario
            }

            if (reservasPorHorario[hora] + parseInt(pax) > limitePax[restaurante]) {
                alert("Se ha alcanzado el límite de pax para el horario seleccionado.");
                return;
            }

            // Crear objeto de reserva
            const reserva = { fecha, room, nombre, restaurante, hora, pax, notas };

            // Guardar reserva en localStorage
            const reservas = JSON.parse(localStorage.getItem('reservas')) || [];
            reservas.push(reserva);
            localStorage.setItem('reservas', JSON.stringify(reservas));

            // Agregar fila a la tabla
            addRowToTable(reserva);

            // Actualizar el conteo de pax para el horario
            reservasPorHorario[hora] += parseInt(pax);

            // Reiniciar el formulario
            form.reset();
            horaSelect.innerHTML = '<option value="">Seleccione un horario</option>'; // Resetear horarios
        });
    </script>
</body>
</html>
